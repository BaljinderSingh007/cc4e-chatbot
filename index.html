<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; style-src 'self' 'unsafe-inline'; script-src 'self'; img-src 'self' data:; connect-src 'self' http://localhost:8085;">
  <title>CC4E Chatbot Assistant</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="app-container">
    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
      <div class="sidebar-header">
        <button class="new-chat-btn" id="newChatBtn">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M12 5v14M5 12h14"/>
          </svg>
          <span>New Chat</span>
        </button>
      </div>

      <div class="chat-history" id="chatHistory">
        <div class="history-section">
          <h3>Today</h3>
          <div class="history-items" id="todayChats"></div>
        </div>
        <div class="history-section">
          <h3>Previous 7 Days</h3>
          <div class="history-items" id="weekChats"></div>
        </div>
        <div class="history-section">
          <h3>Previous 30 Days</h3>
          <div class="history-items" id="monthChats"></div>
        </div>
      </div>

      <div class="sidebar-footer">
        <button class="settings-btn" id="settingsBtn">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="3"/>
            <path d="M12 1v6m0 6v6m-8-8h6m6 0h6m-1-8l-5 5m0 6l5 5m-16-8l5 5m0-16l-5 5"/>
          </svg>
          <span>Settings</span>
        </button>
      </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
      <!-- Header -->
      <header class="chat-header">
        <button class="sidebar-toggle" id="sidebarToggle">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M3 12h18M3 6h18M3 18h18"/>
          </svg>
        </button>
        <div class="header-title">
          <h1 id="chatTitle">CC4E Assistant</h1>
        </div>
        <div class="header-actions">
          <button class="icon-btn" id="exportBtn" title="Export Chat">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
              <polyline points="7 10 12 15 17 10"/>
              <line x1="12" y1="15" x2="12" y2="3"/>
            </svg>
          </button>
          <button class="icon-btn" id="clearBtn" title="Clear Chat">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="3 6 5 6 21 6"/>
              <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
            </svg>
          </button>
        </div>
      </header>

      <!-- Chat Messages -->
      <div class="chat-container" id="chatContainer">
        <!-- Welcome Screen -->
        <div class="welcome-screen" id="welcomeScreen">
          <div class="welcome-content">
            <div class="logo">
              <svg width="80" height="80" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/>
              </svg>
            </div>
            <h1>CC4E Chatbot Assistant</h1>
            <p>Ask me anything! I can help you with projects, contracts, and general information.</p>
            
            <!-- Quick Actions -->
            <div class="quick-actions-grid" id="quickActions">
              <button class="quick-action-card" data-action="projects">
                <div class="action-icon" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                  <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"/>
                  </svg>
                </div>
                <h3>Show all projects</h3>
                <p>View and manage all your projects</p>
              </button>

              <button class="quick-action-card" data-action="contracts">
                <div class="action-icon" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
                  <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                    <polyline points="14 2 14 8 20 8"/>
                    <line x1="16" y1="13" x2="8" y2="13"/>
                    <line x1="16" y1="17" x2="8" y2="17"/>
                    <polyline points="10 9 9 9 8 9"/>
                  </svg>
                </div>
                <h3>Show all contracts</h3>
                <p>Access contract information</p>
              </button>

              <button class="quick-action-card" data-action="project-id">
                <div class="action-icon" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
                  <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="11" cy="11" r="8"/>
                    <path d="m21 21-4.35-4.35"/>
                  </svg>
                </div>
                <h3>Search project by ID</h3>
                <p>Find specific project details</p>
              </button>

              <button class="quick-action-card" data-action="help">
                <div class="action-icon" style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);">
                  <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"/>
                    <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/>
                    <line x1="12" y1="17" x2="12.01" y2="17"/>
                  </svg>
                </div>
                <h3>How can you help?</h3>
                <p>Learn about my capabilities</p>
              </button>
            </div>
          </div>
        </div>

        <!-- Messages Area -->
        <div class="messages-area" id="messagesArea"></div>
      </div>

      <!-- Input Area -->
      <div class="input-container">
        <div class="input-wrapper">
          <textarea 
            id="messageInput" 
            class="message-input" 
            placeholder="Type your message..." 
            rows="1"></textarea>
          <button class="send-btn" id="sendBtn" disabled>
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="22" y1="2" x2="11" y2="13"/>
              <polygon points="22 2 15 22 11 13 2 9 22 2"/>
            </svg>
          </button>
        </div>
        <div class="input-footer">
          <span class="character-count" id="charCount">0 / 2000</span>
          <span class="hint">Press Enter to send, Shift+Enter for new line</span>
        </div>
      </div>
    </main>
  </div>

  <!-- Modal for Project/Contract ID Input -->
  <div class="modal" id="inputModal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 id="modalTitle">Enter ID</h2>
        <button class="modal-close" id="modalClose">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"/>
            <line x1="6" y1="6" x2="18" y2="18"/>
          </svg>
        </button>
      </div>
      <div class="modal-body">
        <input type="text" id="modalInput" class="modal-input" placeholder="Enter ID...">
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" id="modalCancel">Cancel</button>
        <button class="btn btn-primary" id="modalSubmit">Submit</button>
      </div>
    </div>
  </div>

  <!-- Settings Modal -->
  <div class="modal" id="settingsModal">
    <div class="modal-content settings-modal-content">
      <div class="modal-header">
        <h2>Settings</h2>
        <button class="modal-close" id="settingsModalClose">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"/>
            <line x1="6" y1="6" x2="18" y2="18"/>
          </svg>
        </button>
      </div>
      <div class="modal-body settings-body">
        <div class="settings-tabs">
          <button class="settings-tab active" data-tab="mcp-servers">MCP Servers</button>
          <button class="settings-tab" data-tab="general">General</button>
        </div>
        
        <div class="settings-content">
          <!-- MCP Servers Tab -->
          <div class="settings-panel active" id="mcp-servers-panel">
            <div class="settings-section">
              <h3>MCP Server Configuration</h3>
              <p class="settings-description">Configure Model Context Protocol servers to extend chatbot capabilities</p>
              
              <div class="mcp-servers-list" id="mcpServersList">
                <!-- Servers will be dynamically added here -->
              </div>
              
              <button class="btn btn-primary" id="addMcpServerBtn">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M12 5v14M5 12h14"/>
                </svg>
                Add MCP Server
              </button>
            </div>
          </div>

          <!-- General Tab -->
          <div class="settings-panel" id="general-panel">
            <div class="settings-section">
              <h3>General Settings</h3>
              <p class="settings-description">Configure general application settings</p>
              
              <div class="setting-item">
                <label>Theme</label>
                <select class="setting-select" id="themeSelect">
                  <option value="light">Light</option>
                  <option value="dark">Dark</option>
                  <option value="system">System</option>
                </select>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" id="settingsModalCancel">Cancel</button>
        <button class="btn btn-primary" id="settingsModalSave">Save</button>
      </div>
    </div>
  </div>

  <!-- MCP Server Configuration Modal -->
  <div class="modal" id="mcpServerModal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 id="mcpServerModalTitle">Add MCP Server</h2>
        <button class="modal-close" id="mcpServerModalClose">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"/>
            <line x1="6" y1="6" x2="18" y2="18"/>
          </svg>
        </button>
      </div>
      <div class="modal-body mcp-server-form">
        <div class="form-group">
          <label for="mcpServerIcon">Icon (optional)</label>
          <div class="icon-upload-area" id="iconUploadArea">
            <input type="file" id="mcpServerIcon" accept="image/*" style="display: none;">
            <div class="icon-preview" id="iconPreview">
              <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
                <circle cx="8.5" cy="8.5" r="1.5"/>
                <polyline points="21 15 16 10 5 21"/>
              </svg>
              <p>Click to upload icon</p>
              <small>Minimum size: 128 x 128 px</small>
            </div>
          </div>
        </div>

        <div class="form-group">
          <label for="mcpServerName">Name *</label>
          <input type="text" id="mcpServerName" class="form-input" placeholder="Custom Tool" required>
        </div>

        <div class="form-group">
          <label for="mcpServerDescription">Description (optional)</label>
          <textarea id="mcpServerDescription" class="form-textarea" placeholder="Explain what it does in a few words" rows="3"></textarea>
        </div>

        <div class="form-group">
          <label for="mcpServerUrl">MCP Server URL *</label>
          <input type="url" id="mcpServerUrl" class="form-input" placeholder="http://localhost:8085" required>
        </div>

        <input type="hidden" id="mcpServerId">
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" id="mcpServerModalCancel">Cancel</button>
        <button class="btn btn-primary" id="mcpServerModalSave">Save</button>
      </div>
    </div>
  </div>

  <script src="renderer.js"></script>
</body>
</html>
